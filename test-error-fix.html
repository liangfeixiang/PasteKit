<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é…ç½®ç®¡ç†é”™è¯¯ä¿®å¤æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="p-6">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">ğŸ”§ é…ç½®ç®¡ç†é”™è¯¯ä¿®å¤æµ‹è¯•</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">é”™è¯¯ä¿®å¤éªŒè¯</h2>
            
            <div class="space-y-4">
                <div class="p-4 bg-green-50 rounded-lg">
                    <h3 class="font-medium text-green-800">âœ… å·²ä¿®å¤çš„é—®é¢˜</h3>
                    <ul class="mt-2 text-green-700 text-sm space-y-1">
                        <li>â€¢ æ·»åŠ äº†å¯¹ config.algorithm çš„ç©ºå€¼æ£€æŸ¥</li>
                        <li>â€¢ ä½¿ç”¨å¯é€‰é“¾æ“ä½œç¬¦ (?.) é˜²æ­¢ undefined é”™è¯¯</li>
                        <li>â€¢ ä¸ºåˆ†å‰²æ“ä½œæ·»åŠ é»˜è®¤å€¼å›é€€</li>
                        <li>â€¢ ç»Ÿä¸€äº†æ–°æ—§é…ç½®æ ¼å¼çš„å…¼å®¹æ€§å¤„ç†</li>
                    </ul>
                </div>
                
                <div class="p-4 bg-blue-50 rounded-lg">
                    <h3 class="font-medium text-blue-800">ğŸ“‹ æµ‹è¯•ç”¨ä¾‹</h3>
                    <div class="mt-2 space-y-2 text-sm">
                        <div class="flex justify-between p-2 bg-white rounded">
                            <span>æ­£å¸¸é…ç½®:</span>
                            <span class="font-mono text-blue-600">AES/CBC/PKCS7</span>
                        </div>
                        <div class="flex justify-between p-2 bg-white rounded">
                            <span>ç¼ºå°‘algorithm:</span>
                            <span class="font-mono text-orange-600">undefined</span>
                        </div>
                        <div class="flex justify-between p-2 bg-white rounded">
                            <span>æ–°æ ¼å¼é…ç½®:</span>
                            <span class="font-mono text-green-600">algorithmType: AES</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="text-center">
            <button onclick="runTests()" class="px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 mr-4">
                ğŸ§ª è¿è¡Œæµ‹è¯•
            </button>
            <button onclick="clearConsole()" class="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600">
                ğŸ§¹ æ¸…é™¤æ—¥å¿—
            </button>
        </div>
        
        <div class="mt-6 bg-black text-green-400 p-4 rounded-lg font-mono text-sm">
            <div id="console-output" class="h-64 overflow-y-auto">
                > æ§åˆ¶å°è¾“å‡ºå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
            </div>
        </div>
    </div>

    <script>
        function log(message) {
            const consoleOutput = document.getElementById('console-output');
            const timestamp = new Date().toLocaleTimeString();
            consoleOutput.innerHTML += `[${timestamp}] ${message}\n`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            console.log(message);
        }
        
        function clearConsole() {
            document.getElementById('console-output').innerHTML = '> æ§åˆ¶å°å·²æ¸…ç©º...\n';
        }
        
        function runTests() {
            clearConsole();
            log('ğŸ§ª å¼€å§‹è¿è¡Œé…ç½®ç®¡ç†é”™è¯¯ä¿®å¤æµ‹è¯•...');
            
            // æµ‹è¯•ç”¨ä¾‹
            const testCases = [
                {
                    name: 'æ­£å¸¸é…ç½®',
                    config: { 
                        name: 'æµ‹è¯•é…ç½®1', 
                        algorithm: 'AES/CBC/PKCS7',
                        algorithmType: 'AES',
                        mode: 'CBC',
                        padding: 'PKCS7'
                    }
                },
                {
                    name: 'ç¼ºå°‘algorithmå­—æ®µ',
                    config: { 
                        name: 'æµ‹è¯•é…ç½®2',
                        algorithmType: 'SM4',
                        mode: 'ECB',
                        padding: 'NoPadding'
                    }
                },
                {
                    name: 'RSAé…ç½®',
                    config: { 
                        name: 'RSAé…ç½®',
                        algorithm: 'RSA',
                        algorithmType: 'RSA'
                    }
                },
                {
                    name: 'å®Œå…¨ç¼ºå¤±é…ç½®',
                    config: { 
                        name: 'ç©ºé…ç½®'
                    }
                }
            ];
            
            testCases.forEach((testCase, index) => {
                log(`\n--- æµ‹è¯• ${index + 1}: ${testCase.name} ---`);
                
                try {
                    // æ¨¡æ‹Ÿè¡¨æ ¼æ˜¾ç¤ºé€»è¾‘
                    const algorithmDisplay = testCase.config.algorithmType || testCase.config.algorithm?.split('/')[0] || 'AES';
                    log(`ç®—æ³•ç±»å‹æ˜¾ç¤º: ${algorithmDisplay}`);
                    
                    // æ¨¡æ‹Ÿæ¨¡å¼/å¡«å……æ˜¾ç¤ºé€»è¾‘
                    if (testCase.config.algorithmType === 'RSA' || testCase.config.algorithm?.startsWith('RSA')) {
                        log('æ¨¡å¼/å¡«å……: N/A (RSAç®—æ³•)');
                    } else {
                        const mode = testCase.config.mode || testCase.config.algorithm?.split('/')[1] || 'CBC';
                        const padding = testCase.config.padding || testCase.config.algorithm?.split('/')[2] || 'PKCS5Padding';
                        log(`æ¨¡å¼/å¡«å……: ${mode} / ${padding}`);
                    }
                    
                    log('âœ… æµ‹è¯•é€šè¿‡');
                } catch (error) {
                    log(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`);
                }
            });
            
            log('\nğŸ‰ æ‰€æœ‰æµ‹è¯•å®Œæˆ!');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡Œä¸€æ¬¡æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(runTests, 1000);
        });
    </script>
</body>
</html>